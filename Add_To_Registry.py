import ctypes, sys

# run with admin role
def is_admin():
    try:
        return ctypes.windll.shell32.IsUserAnAdmin()
    except:
        return False

#This help users that use the tool conveniently
if is_admin():
    import os
    import sys
    import winreg as reg

    # Get path of current working directory and python.exe
    cwd = os.getcwd()
    python_exe = sys.executable

    # Set the path of the context menu (right-click menu)
    key_path = r'*\\shell\\Scanner\\'

    # Create outer key
    key = reg.CreateKey(reg.HKEY_CLASSES_ROOT, key_path)
    reg.SetValue(key, '', reg.REG_SZ, '&WMS Scan')

    # create inner key and value in registry
    key1 = reg.CreateKey(key, r"command")
    reg.SetValue(key1, '', reg.REG_SZ, "C:\\ProgramData\\WMS Scanner\\Scan.exe" + " " f'"%1"')
else:
    ctypes.windll.shell32.ShellExecuteW(None, "runas", sys.executable, " ".join(sys.argv), None, 1)
